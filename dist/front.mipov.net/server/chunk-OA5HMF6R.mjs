import './polyfills.server.mjs';
import{a as T,b as P,c as w,f as F,h as j,o as D}from"./chunk-N4LW2J7B.mjs";import{a as b}from"./chunk-OTV2TRQT.mjs";import{m as k}from"./chunk-M5PVHEUU.mjs";import{b as E}from"./chunk-HTRSZA6C.mjs";import{L as C,La as f,Na as s,Oa as _,Pa as c,Pb as V,Qa as o,R as m,Ra as p,Sa as S,Ta as y,V as g,Va as v,Wa as u,bb as a,cb as h,db as x,fb as I,wa as n}from"./chunk-6OPP236L.mjs";import"./chunk-NDYDZJSS.mjs";var M=(()=>{let t=class t{constructor(){this._http=m(E)}getVerificationCode(){return this._http.get(`${b.apiUrl}/mail/mail-verification-code`)}submitEmailVerificationCode(r){return this._http.post(`${b.apiUrl}/mail/submit-email-verification-code`,r)}};t.\u0275fac=function(d){return new(d||t)},t.\u0275prov=C({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function A(e,t){if(e&1&&(c(0,"div",13),a(1),o()),e&2){let l=u();n(),h(l.success)}}function N(e,t){if(e&1&&(c(0,"div",14),a(1),o()),e&2){let l=u();n(),h(l.error)}}function O(e,t){e&1&&p(0,"div",15)}function $(e,t){if(e&1&&(S(0),a(1),y()),e&2){let l=u();n(),x("00:",l.resendCounter<10?"0"+l.resendCounter:l.resendCounter,"")}}var Z=(()=>{let t=class t{constructor(){this._emailVerificationService=m(M),this._router=m(k),this.verificationCode=new F("",[P.required]),this.loading=!1,this.resendCounter=0,this.isSubmitSuccess=!1}getVerificationCode(){this.resendCounter=30,this.error=void 0,this.loading=!0,this._emailVerificationService.getVerificationCode().subscribe({next:({message:r})=>{this.success=r,this.loading=!1,this.counterInterval=setInterval(()=>{this.resendCounter--,this.resendCounter==0&&clearInterval(this.counterInterval)},1e3),setTimeout(()=>{this.success=void 0},5e3)}})}submit(){this._emailVerificationService.submitEmailVerificationCode({verificationCode:this.verificationCode.value}).subscribe({next:({message:r})=>{this.isSubmitSuccess=!0,this.success=r,setTimeout(()=>{this.success=void 0,this._router.navigateByUrl("/profile")},3e3)},error:r=>{this.error=r.error.message}})}};t.\u0275fac=function(d){return new(d||t)},t.\u0275cmp=g({type:t,selectors:[["app-email-verification-page"]],standalone:!0,features:[I],decls:20,vars:10,consts:[[1,"container","py-3"],[1,"card","mx-auto",2,"max-width","420px"],[1,"card-body"],[1,"card-title"],[1,"form-group","mb-2"],["for","Verification-code"],["type","text","id","Verification-code","placeholder","for exapmle: 3411254",1,"form-control",3,"readOnly","formControl"],["class","alert alert-success",4,"ngIf"],["class","alert alert-danger",4,"ngIf"],[1,"btn","btn-link","w-100","mb-2",2,"text-decoration","none",3,"click","disabled"],["class","spinner-border spinner-border-sm","role","status",4,"ngIf"],[4,"ngIf"],[1,"btn","btn-primary","w-100",3,"click","disabled"],[1,"alert","alert-success"],[1,"alert","alert-danger"],["role","status",1,"spinner-border","spinner-border-sm"]],template:function(d,i){d&1&&(c(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),a(4,"Email verification"),o(),c(5,"p"),a(6,"An email verification code has been sent to your email. Please check your inbox and paste the code in the form control below. If you haven't received the code, please check your spam folder."),o(),c(7,"div",4)(8,"label",5)(9,"b"),a(10,"Verification Code"),o()(),p(11,"input",6),o(),f(12,A,2,1,"div",7)(13,N,2,1,"div",8),c(14,"button",9),v("click",function(){return i.getVerificationCode()}),f(15,O,1,0,"div",10),a(16," Resend "),f(17,$,2,1,"ng-container",11),o(),c(18,"button",12),v("click",function(){return i.submit()}),a(19," Submit "),o()()()()),d&2&&(n(11),_("is-invalid",i.error),s("readOnly",i.isSubmitSuccess)("formControl",i.verificationCode),n(),s("ngIf",i.success),n(),s("ngIf",i.error),n(),s("disabled",i.loading||i.resendCounter>0||i.isSubmitSuccess),n(),s("ngIf",i.loading),n(2),s("ngIf",!i.loading&&i.resendCounter>0),n(),s("disabled",i.loading||i.verificationCode.invalid||i.isSubmitSuccess))},dependencies:[V,D,T,w,j]});let e=t;return e})();export{Z as EmailVerificationPageComponent};
