import{b as H}from"./chunk-65TJLP2W.js";import{a as Y}from"./chunk-2IV55B4M.js";import{a as k,b as n,c as V,d as q,e as g,f as u,g as O,h as $,k as M,n as R}from"./chunk-XCU5Y4OB.js";import{d as U,g as D,i as T}from"./chunk-25DZAR4D.js";import"./chunk-74JUVWB4.js";import"./chunk-QFTSOMBC.js";import{Ib as I,Jb as G,M as b,Na as w,Pa as m,Qa as c,Ra as i,Sa as t,Ta as f,Ua as E,V as h,Va as F,Wa as y,Xa as N,Ya as p,Z as S,db as r,eb as _,fa as v,fb as P,ga as x,hb as C,ib as L,jb as A,ya as a}from"./chunk-FEPXA7XF.js";function z(o,d){if(o&1&&(i(0,"div",33),r(1),t()),o&2){let e=p(2);a(),_(e.updateUserNameFirstNameLastNameAboutError)}}function B(o,d){o&1&&(i(0,"div",34),r(1,"\u{1F389} Your personal information successfully updated."),t())}function J(o,d){if(o&1&&(i(0,"div",33),r(1),t()),o&2){let e=p(2);a(),_(e.error.message)}}function Z(o,d){if(o&1&&(i(0,"div",35),r(1),t()),o&2){let e=p(2);a(),_(e.updatePasswordError)}}function K(o,d){if(o&1&&(i(0,"div",34),r(1),t()),o&2){let e=p(2);a(),_(e.updatePasswordSuccess)}}function Q(o,d){if(o&1){let e=y();E(0),i(1,"div",1)(2,"h2"),r(3,"Personal info"),t(),i(4,"div",2)(5,"div",3)(6,"form",4)(7,"label",5),r(8,"User name:"),t(),i(9,"div",6)(10,"span",7),r(11,"https://mipov.net/"),t(),f(12,"input",8),w(13,z,2,1,"div",9),t(),i(14,"label",10),r(15,"First name:"),t(),i(16,"div",6)(17,"span",7),r(18,"\u{1F464}"),t(),f(19,"input",11),t(),i(20,"label",12),r(21,"Last name:"),t(),i(22,"div",6)(23,"span",7),r(24,"\u{1F3A9}"),t(),f(25,"input",13),t(),i(26,"label",14),r(27,"About:"),t(),i(28,"div",6),f(29,"textarea",15),t(),w(30,B,2,0,"div",16),i(31,"button",17),N("click",function(){v(e);let l=p();return x(l.updateUserNameFirstNameLastNameAbout())}),r(32,"Save"),t()()()(),i(33,"h2"),r(34,"Email"),t(),i(35,"div",2)(36,"div",3)(37,"label",18),r(38,"Email:"),t(),i(39,"div",6)(40,"span",7),r(41,"\u2709\uFE0F"),t(),f(42,"input",19),w(43,J,2,1,"div",9),t(),i(44,"div",20),r(45,"You'll be able to change the email address associated with your account. Thank you for your patience!"),t()()(),i(46,"h2"),r(47,"Password"),t(),i(48,"div",21)(49,"div",3)(50,"form",4)(51,"label",22),r(52,"Password:"),t(),i(53,"div",23)(54,"span",7),r(55,"\u{1F512}"),t(),f(56,"input",24),t(),i(57,"div",25)(58,"input",26),N("change",function(){v(e);let l=p();return x(l.showOldPassword=!l.showOldPassword)}),t(),i(59,"label",27)(60,"u"),r(61),t()()(),w(62,Z,2,1,"div",28),i(63,"label",29),r(64,"New password:"),t(),i(65,"div",23)(66,"span",7),r(67,"\u{1F512}"),t(),f(68,"input",30),t(),i(69,"div",25)(70,"input",31),N("change",function(){v(e);let l=p();return x(l.showNewPassword=!l.showNewPassword)}),t(),i(71,"label",32)(72,"u"),r(73),t()()(),w(74,K,2,1,"div",16),i(75,"button",17),N("click",function(){v(e);let l=p();return x(l.updatePassword())}),r(76,"Change password"),t()()()()(),F()}if(o&2){let e=p();a(6),m("formGroup",e.personalInfoFormGroup),a(3),c("has-validation",e.updateUserNameFirstNameLastNameAboutError),a(3),c("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess)("is-invalid",e.updateUserNameFirstNameLastNameAboutError),a(),m("ngIf",e.updateUserNameFirstNameLastNameAboutError),a(6),c("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess),a(6),c("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess),a(4),c("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess),a(),m("ngIf",e.updateUserNameFirstNameLastNameAboutSuccess),a(),m("disabled",e.personalInfoFormGroup.invalid||e.updateUserNameFirstNameLastNameAboutSuccess),a(11),m("disabled",!0)("value",e.email.value),a(),m("ngIf",(e.error==null?null:e.error.errorType)=="email"),a(7),m("formGroup",e.passwordsFormGroup),a(6),c("is-valid",e.updatePasswordSuccess)("is-invalid",e.updatePasswordError),m("type",e.showOldPassword?"text":"password"),a(5),P("",e.showOldPassword?"Hide":"Show"," password"),a(),m("ngIf",e.updatePasswordError),a(6),c("is-valid",e.updatePasswordSuccess),m("type",e.showNewPassword?"text":"password"),a(5),P("",e.showNewPassword?"Hide":"Show"," new password"),a(),m("ngIf",e.updatePasswordSuccess),a(),m("disabled",e.passwordsFormGroup.invalid||e.updatePasswordSuccess)}}var de=(()=>{let d=class d{constructor(){this._profileService=h(Y),this._route=h(D),this._router=h(T),this._title=h(U),this.authenticationService=h(H),this.personalInfoFormGroup=new g({userName:new u("",[n.required,n.minLength(2),n.maxLength(255),n.pattern(new RegExp("^[a-zA-Z0-9]+$"))]),firstName:new u("",[n.required,n.maxLength(255)]),lastName:new u("",[n.required,n.maxLength(255)]),about:new u("",[n.maxLength(35)])}),this.passwordsFormGroup=new g({oldPassword:new u("",[n.required,n.minLength(6),n.maxLength(255)]),newPassword:new u("",[n.required,n.minLength(6),n.maxLength(255)])}),this.emailsFormGroup=new g({email:new u("",[n.required,n.email,n.minLength(6),n.maxLength(255)]),newEmail:new u("",[n.required,n.email,n.minLength(6),n.maxLength(255)])}),this.updateUserNameFirstNameLastNameAboutSuccess=!1,this.showOldPassword=!1,this.showNewPassword=!1}ngOnInit(){this.user$=this._profileService.profile(this._route.snapshot.params.userName).pipe(b(s=>{this.emailsFormGroup.patchValue(s),this.personalInfoFormGroup.patchValue(s),this._title.setTitle(`mipov.net - ${s.userName}`)}))}updatePassword(){this._profileService.updatePassword(this.passwordsFormGroup.value).subscribe({next:({message:s})=>{this.updatePasswordSuccess=s,setTimeout(()=>{this.updatePasswordSuccess=null,this.passwordsFormGroup.reset()},3e3),this.updatePasswordError=null},error:s=>{this.updatePasswordError=s.error.message,console.log(s)}})}updateUserNameFirstNameLastNameAbout(){this._profileService.updateUserNameFirstNameLastNameAbout(this.personalInfoFormGroup.value).subscribe({next:()=>{this.updateUserNameFirstNameLastNameAboutSuccess=!0,setTimeout(()=>{this.updateUserNameFirstNameLastNameAboutSuccess=!1},3e3),this.updateUserNameFirstNameLastNameAboutError=null},error:s=>{this.updateUserNameFirstNameLastNameAboutError=s.error.message}})}get userName(){return this.personalInfoFormGroup.controls.userName}get email(){return this.emailsFormGroup.controls.email}};d.\u0275fac=function(l){return new(l||d)},d.\u0275cmp=S({type:d,selectors:[["app-profile-page"]],standalone:!0,features:[C],decls:2,vars:3,consts:[[4,"ngIf"],[1,"container","py-3"],[1,"card","mb-3"],[1,"card-body"],[3,"formGroup"],["for","userName"],[1,"input-group","mb-3"],[1,"input-group-text"],["id","userName","type","text","formControlName","userName","placeholder","Unique user name",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","name"],["id","name","type","text","formControlName","firstName",1,"form-control"],["for","lastName"],["id","lastName","type","text","formControlName","lastName",1,"form-control"],["for","about"],["formControlName","about","id","about",1,"form-control"],["class","alert alert-success",4,"ngIf"],[1,"btn","btn-success","w-100",3,"click","disabled"],["for","email"],["id","email","type","type",1,"form-control",3,"disabled","value"],[1,"alert","alert-warning","mb-0"],[1,"card"],["for","password"],[1,"input-group","mb-2"],["id","password","formControlName","oldPassword",1,"form-control",3,"type"],[1,"form-check","mb-3"],["type","checkbox","value","","id","showOldPassword",1,"form-check-input",3,"change"],["for","showOldPassword",1,"form-check-label","text-primary","user-select-none"],["class","alert alert-danger",4,"ngIf"],["for","newPassword"],["id","newPassword","formControlName","newPassword",1,"form-control",3,"type"],["type","checkbox","value","","id","showNewPassword",1,"form-check-input",3,"change"],["for","showNewPassword",1,"form-check-label","text-primary","user-select-none"],[1,"invalid-feedback"],[1,"alert","alert-success"],[1,"alert","alert-danger"]],template:function(l,j){l&1&&(w(0,Q,77,33,"ng-container",0),L(1,"async")),l&2&&m("ngIf",A(1,1,j.user$))},dependencies:[I,G,R,O,k,V,q,$,M]});let o=d;return o})();export{de as ProfilePageComponent};
