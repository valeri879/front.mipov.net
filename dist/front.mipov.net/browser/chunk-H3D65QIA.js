import{a as j}from"./chunk-2IV55B4M.js";import{b as Y}from"./chunk-65TJLP2W.js";import{a as V,b as n,c as q,d as O,e as g,f as u,g as R,i as $,l as M,o as H}from"./chunk-26BHK4R3.js";import{d as U,g as D,i as k,j as T}from"./chunk-25DZAR4D.js";import"./chunk-74JUVWB4.js";import"./chunk-QFTSOMBC.js";import{Ib as A,Jb as G,M as S,Na as c,Pa as s,Qa as f,Ra as i,Sa as t,Ta as w,Ua as E,V as v,Va as F,Wa as y,Xa as _,Ya as p,Z as b,db as r,eb as N,fa as h,fb as P,ga as x,hb as C,ib as L,jb as I,ya as a}from"./chunk-FEPXA7XF.js";function B(o,l){o&1&&(i(0,"div",35),r(1,"Please check your email for the verification code. "),i(2,"a",36),r(3,"verify email"),t()())}function J(o,l){if(o&1&&(i(0,"div",37),r(1),t()),o&2){let m=p(2);a(),N(m.updateUserNameFirstNameLastNameAboutError)}}function Z(o,l){o&1&&(i(0,"div",38),r(1,"\u{1F389} Your personal information successfully updated."),t())}function K(o,l){if(o&1&&(i(0,"div",37),r(1),t()),o&2){let m=p(2);a(),N(m.error.message)}}function Q(o,l){if(o&1&&(i(0,"div",39),r(1),t()),o&2){let m=p(2);a(),N(m.updatePasswordError)}}function W(o,l){if(o&1&&(i(0,"div",38),r(1),t()),o&2){let m=p(2);a(),N(m.updatePasswordSuccess)}}function X(o,l){if(o&1){let m=y();E(0),i(1,"div",1),c(2,B,4,0,"div",2),i(3,"h2"),r(4,"Personal info"),t(),i(5,"div",3)(6,"div",4)(7,"form",5)(8,"label",6),r(9,"User name:"),t(),i(10,"div",7)(11,"span",8)(12,"span",9),r(13,"https:"),t(),r(14,"//mipov.net/"),t(),w(15,"input",10),c(16,J,2,1,"div",11),t(),i(17,"label",12),r(18,"First name:"),t(),i(19,"div",7)(20,"span",8),r(21,"\u{1F464}"),t(),w(22,"input",13),t(),i(23,"label",14),r(24,"Last name:"),t(),i(25,"div",7)(26,"span",8),r(27,"\u{1F3A9}"),t(),w(28,"input",15),t(),i(29,"label",16),r(30,"About:"),t(),i(31,"div",7),w(32,"textarea",17),t(),c(33,Z,2,0,"div",18),i(34,"button",19),_("click",function(){h(m);let d=p();return x(d.updateUserNameFirstNameLastNameAbout())}),r(35,"Save"),t()()()(),i(36,"h2"),r(37,"Email"),t(),i(38,"div",3)(39,"div",4)(40,"label",20),r(41,"Email:"),t(),i(42,"div",7)(43,"span",8),r(44,"\u2709\uFE0F"),t(),w(45,"input",21),c(46,K,2,1,"div",11),t(),i(47,"div",22),r(48,"You'll be able to change the email address associated with your account. Thank you for your patience!"),t()()(),i(49,"h2"),r(50,"Password"),t(),i(51,"div",23)(52,"div",4)(53,"form",5)(54,"label",24),r(55,"Password:"),t(),i(56,"div",25)(57,"span",8),r(58,"\u{1F512}"),t(),w(59,"input",26),t(),i(60,"div",27)(61,"input",28),_("change",function(){h(m);let d=p();return x(d.showOldPassword=!d.showOldPassword)}),t(),i(62,"label",29)(63,"u"),r(64),t()()(),c(65,Q,2,1,"div",30),i(66,"label",31),r(67,"New password:"),t(),i(68,"div",25)(69,"span",8),r(70,"\u{1F512}"),t(),w(71,"input",32),t(),i(72,"div",27)(73,"input",33),_("change",function(){h(m);let d=p();return x(d.showNewPassword=!d.showNewPassword)}),t(),i(74,"label",34)(75,"u"),r(76),t()()(),c(77,W,2,1,"div",18),i(78,"button",19),_("click",function(){h(m);let d=p();return x(d.updatePassword())}),r(79,"Change password"),t()()()()(),F()}if(o&2){let m=l.ngIf,e=p();a(2),s("ngIf",!m.isVerified),a(5),s("formGroup",e.personalInfoFormGroup),a(3),f("has-validation",e.updateUserNameFirstNameLastNameAboutError),a(5),f("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess)("is-invalid",e.updateUserNameFirstNameLastNameAboutError),a(),s("ngIf",e.updateUserNameFirstNameLastNameAboutError),a(6),f("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess),a(6),f("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess),a(4),f("is-valid",e.updateUserNameFirstNameLastNameAboutSuccess),a(),s("ngIf",e.updateUserNameFirstNameLastNameAboutSuccess),a(),s("disabled",e.personalInfoFormGroup.invalid||e.updateUserNameFirstNameLastNameAboutSuccess),a(11),s("disabled",!0)("value",e.email.value),a(),s("ngIf",(e.error==null?null:e.error.errorType)=="email"),a(7),s("formGroup",e.passwordsFormGroup),a(6),f("is-valid",e.updatePasswordSuccess)("is-invalid",e.updatePasswordError),s("type",e.showOldPassword?"text":"password"),a(5),P("",e.showOldPassword?"Hide":"Show"," password"),a(),s("ngIf",e.updatePasswordError),a(6),f("is-valid",e.updatePasswordSuccess),s("type",e.showNewPassword?"text":"password"),a(5),P("",e.showNewPassword?"Hide":"Show"," new password"),a(),s("ngIf",e.updatePasswordSuccess),a(),s("disabled",e.passwordsFormGroup.invalid||e.updatePasswordSuccess)}}var ue=(()=>{let l=class l{constructor(){this._profileService=v(j),this._route=v(D),this._router=v(k),this._title=v(U),this.authenticationService=v(Y),this.personalInfoFormGroup=new g({userName:new u("",[n.required,n.minLength(2),n.maxLength(255),n.pattern(new RegExp("^[a-zA-Z0-9]+$"))]),firstName:new u("",[n.required,n.maxLength(255)]),lastName:new u("",[n.required,n.maxLength(255)]),about:new u("",[n.maxLength(35)])}),this.passwordsFormGroup=new g({oldPassword:new u("",[n.required,n.minLength(6),n.maxLength(255)]),newPassword:new u("",[n.required,n.minLength(6),n.maxLength(255)])}),this.emailsFormGroup=new g({email:new u("",[n.required,n.email,n.minLength(6),n.maxLength(255)]),newEmail:new u("",[n.required,n.email,n.minLength(6),n.maxLength(255)])}),this.updateUserNameFirstNameLastNameAboutSuccess=!1,this.showOldPassword=!1,this.showNewPassword=!1}ngOnInit(){this.user$=this._profileService.profile(this._route.snapshot.params.userName).pipe(S(e=>{this.emailsFormGroup.patchValue(e),this.personalInfoFormGroup.patchValue(e),this._title.setTitle(`mipov.net - ${e.userName}`)}))}updatePassword(){this._profileService.updatePassword(this.passwordsFormGroup.value).subscribe({next:({message:e})=>{this.updatePasswordSuccess=e,setTimeout(()=>{this.updatePasswordSuccess=null,this.passwordsFormGroup.reset()},3e3),this.updatePasswordError=null},error:e=>{this.updatePasswordError=e.error.message,console.log(e)}})}updateUserNameFirstNameLastNameAbout(){this._profileService.updateUserNameFirstNameLastNameAbout(this.personalInfoFormGroup.value).subscribe({next:()=>{this.updateUserNameFirstNameLastNameAboutSuccess=!0,setTimeout(()=>{this.updateUserNameFirstNameLastNameAboutSuccess=!1},3e3),this.updateUserNameFirstNameLastNameAboutError=null},error:e=>{this.updateUserNameFirstNameLastNameAboutError=e.error.message}})}get userName(){return this.personalInfoFormGroup.controls.userName}get email(){return this.emailsFormGroup.controls.email}};l.\u0275fac=function(d){return new(d||l)},l.\u0275cmp=b({type:l,selectors:[["app-profile-page"]],standalone:!0,features:[C],decls:2,vars:3,consts:[[4,"ngIf"],[1,"container","py-3"],["class","alert alert-warning",4,"ngIf"],[1,"card","mb-3"],[1,"card-body"],[3,"formGroup"],["for","userName"],[1,"input-group","mb-3"],[1,"input-group-text"],[1,"text-success"],["id","userName","type","text","formControlName","userName","placeholder","Unique user name",1,"form-control"],["class","invalid-feedback",4,"ngIf"],["for","name"],["id","name","type","text","formControlName","firstName",1,"form-control"],["for","lastName"],["id","lastName","type","text","formControlName","lastName",1,"form-control"],["for","about"],["formControlName","about","id","about",1,"form-control"],["class","alert alert-success",4,"ngIf"],[1,"btn","btn-success","w-100",3,"click","disabled"],["for","email"],["id","email","type","type",1,"form-control",3,"disabled","value"],[1,"alert","alert-warning","mb-0"],[1,"card"],["for","password"],[1,"input-group","mb-2"],["id","password","formControlName","oldPassword",1,"form-control",3,"type"],[1,"form-check","mb-3"],["type","checkbox","value","","id","showOldPassword",1,"form-check-input",3,"change"],["for","showOldPassword",1,"form-check-label","text-primary","user-select-none"],["class","alert alert-danger",4,"ngIf"],["for","newPassword"],["id","newPassword","formControlName","newPassword",1,"form-control",3,"type"],["type","checkbox","value","","id","showNewPassword",1,"form-check-input",3,"change"],["for","showNewPassword",1,"form-check-label","text-primary","user-select-none"],[1,"alert","alert-warning"],["routerLink","/email-verification"],[1,"invalid-feedback"],[1,"alert","alert-success"],[1,"alert","alert-danger"]],template:function(d,z){d&1&&(c(0,X,80,34,"ng-container",0),L(1,"async")),d&2&&s("ngIf",I(1,1,z.user$))},dependencies:[A,G,H,R,V,q,O,$,M,T]});let o=l;return o})();export{ue as ProfilePageComponent};
